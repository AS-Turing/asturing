name: 🔐 Test Secrets via Environment

on:
  push:
    branches: [master, main]

jobs:
  debug:
    runs-on: ubuntu-latest
    environment: production

    steps:
      - name: 🔍 Show actual SSH_HOST contents (debug)
        run: |
          echo "Raw SSH_HOST (with markers):"
          echo ">${{ secrets.SSH_HOST }}<" | cat -A
          echo
          echo "Raw SSH_USER (with markers):"
          echo ">${{ secrets.SSH_USER }}<" | cat -A
          echo
          echo "Raw DEPLOY_PATH (with markers):"
          echo ">${{ secrets.DEPLOY_PATH }}<" | cat -A
          echo
          echo "Raw SSH_PRIVATE_KEY (with markers):"
          echo ">${{ secrets.SSH_PRIVATE_KEY }}<" | head -n 3 | cat -A

      - name: 🧪 Test SSH DNS resolution
        run: |
          echo "Testing SSH_HOST resolution..."
          ping -c 3 ${{ secrets.SSH_HOST }} || echo "❌ Host not reachable or not resolvable"
